<!DOCTYPE html>
<html>
<head>  
	<title>Program #5 - Hannah Burdon</title>
	<meta charset="UTF-8">
        
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js">
    	</script>
    	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js">
    	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.1.2/handlebars.min.js">
	</script>
	<script type="text/x-handlebars-template" id="tableTemplate">

   		 <table class="table table-striped">
       			<tr>
				<th>Name</th>
				<th>Major</th>
				<th>Midterm</th>
				<th>Final</th>
			</tr>
          	 	{{#each rows}}
               		<tr>
                  		<td>{{name}}</td>
				<td>{{major}}</td>
				<td>{{midterm}}</td>
				<td>{{final}}</td>
               		</tr>
           		{{/each}}
  		 </table>
	</script>
  
 
<script type="text/javascript">

	function getData(major) {
		var request = new XMLHttpRequest();
    		request.open('GET', 'cit5students.json');

    		request.onload = function() {

        	var data = JSON.parse(request.responseText);
		majors = data.filter(getMajor) 
		
	function getData(item) {
            	return item.major == major;
        	}

        	if (request.status == 200) {
              	var templateText = document.getElementById('tableTemplate').innerHTML;
             	var compiledTemplateText = Handlebars.compile(templateText);
              	request.open('GET', 'cit5students.json');
			
              	compiledHtml = compiledTemplateText({ rows: majors })
              	document.getElementById('dataTable').innerHTML = compiledHtml; 	
       	 	}
        	else {
            	document.querySelector('#dataTable').innerHTML = "There was an error, or data items not found";
        	}
		}

    		request.send(null);
  	}
  
</script>
</head>
<body>
  
     <div class="container">
            <h1>Select a Major</h1>
      
            <div style='padding: 5px;'>    
               <button type='button' class="btn btn-primary" onClick="getData('CIT)">CIT Majors</button> &nbsp; 
               <button type='button' class="btn btn-primary" onClick="getData('BUS')">Business Majors</button> 
            </div>
      
           <h3>We filter our dataset by major</h3>
           <div id="dataTable">
	   </div>
     </div>
  </body>
</html>
